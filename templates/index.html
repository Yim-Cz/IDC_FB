<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Enviar Mensaje Cifrado</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-dark text-light">
    <div class="container mt-5">
        <h2 class="text-center mb-4">ðŸ›° EnvÃ­o de Mensaje Cifrado</h2>
        <form id="formulario" action="/enviar" method="POST" class="card p-4 bg-secondary">
            <div class="mb-3">
                <label class="form-label">Nombre o alias:</label>
                <input type="text" name="nombre" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Mensaje original:</label>
                <textarea id="mensaje" rows="4" class="form-control" required></textarea>
            </div>

            <div class="mb-3">
                <label class="form-label">ðŸ”‘ Clave (0â€“25):</label>
                <input type="number" id="clave" min="0" max="25" class="form-control" required>
            </div>

            <!-- Campo oculto para el mensaje cifrado -->
            <input type="hidden" name="mensaje" id="mensajeCifrado">

            <button type="submit" class="btn btn-primary w-100">ðŸš€ Cifrar y Enviar</button>
        </form>
    </div>

    <script>
        // FunciÃ³n que cifra con CÃ©sar
        function cifrarCesar(texto, clave) {
            let resultado = "";
            for (let i = 0; i < texto.length; i++) {
                let letra = texto[i];
                if (/[a-zA-Z]/.test(letra)) {
                    let base = letra === letra.toUpperCase() ? 65 : 97;
                    let codigo = texto.charCodeAt(i) - base;
                    let nuevo = (codigo + clave) % 26;
                    resultado += String.fromCharCode(nuevo + base);
                } else {
                    resultado += letra;
                }
            }
            return resultado;
        }

        // Antes de enviar el formulario, cifra el mensaje y lo pone en el campo oculto
        document.getElementById("formulario").addEventListener("submit", function (e) {
            const texto = document.getElementById("mensaje").value;
            const clave = parseInt(document.getElementById("clave").value);
            const cifrado = cifrarCesar(texto, clave);
            document.getElementById("mensajeCifrado").value = cifrado;
        });
    </script>
</body>
</html>
